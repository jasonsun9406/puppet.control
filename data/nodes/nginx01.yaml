---
nginx::nginx_upstreams:
  'KubernetesFARM':
    ensure: present
    members:
      '192.168.1.206:30201':
        server: '192.168.1.206'
        port: 30201
      '192.168.1.207:30201':
        server: '192.168.1.207'
        port: 30201
  'JENKINS':
    ensure: present
    members:
      '192.168.1.201:8080':
        server: '192.168.1.201'
        port: 8080
  'NGINX':
    ensure: present
    members:
      'localhost:80':
        server: 'localhost'
        port: 80

nginx::nginx_servers:
  'toolr.ca':
    listen_port: 80
  '*.k8s.toolr.ca':
    listen_port: 80
  jenkins.toolr.ca:
    listen_port: 80
  nginx01.toolr.ca:
    listen_port: 80

nginx::nginx_locations:
  hello-world-one:
    location: '~* /'
    server: '*.k8s.toolr.ca'
    proxy: http://KubernetesFARM
  jenkins:
    location: '~* /'
    server: jenkins.toolr.ca
    proxy: http://JENKINS
  kubernetes:
    location: '~* /'
    server: toolr.ca
    proxy: http://KubernetesFARM
  nginx_ping:
    location: '/nginx-health'
    server: nginx01.toolr.ca
    proxy: http://NGINX
    location_cfg_append:
      add_header: '"Content-Type" "application/json"'
      return: '200 "healthy"'